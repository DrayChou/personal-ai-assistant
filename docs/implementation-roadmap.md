# Personal AI Assistant 实施路线图 v1.0

## 项目愿景

构建一个**生产级个人 AI 助手**，融合当前系统的智能优势（三层记忆、Supervisor Agent）与 nanobot 的轻量架构（Gateway、多通道），打造既智能又实用的个人助理系统。

**目标代码量**: ~10,000 行（当前 ~8,000 + 新增 ~2,000）
**开发周期**: 3 个月（12 周）
**里程碑**: 4 个阶段，每个阶段可独立交付

---

## 一、项目概览

### 1.1 当前状态评估

```
┌─────────────────────────────────────────────────────────────────┐
│                      能力雷达图                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│     智能能力 (5/5) ⭐⭐⭐⭐⭐                                     │
│         │                                                        │
│    记忆系统 ──────●────── 基础设施 (2/5) ⚠️                     │
│   (L0/L1/L2)      │      (无 Gateway)                          │
│                   │                                              │
│   Agent 架构 ─────┼────── 多通道支持 (1/5) ⚠️                   │
│  (Supervisor)     │      (仅 CLI)                              │
│                   │                                              │
│    工具生态 ──────┴────── 可靠性 (2/5) ⚠️                       │
│   (MCP支持)            (无 Queue)                               │
│                                                                  │
│     目标: 全面提升至 4-5 分                                     │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 成功标准 (Definition of Done)

| 维度 | 当前 | 目标 | 验收标准 |
|------|------|------|----------|
| **功能完整** | CLI only | 多通道 | 支持 Telegram + Discord + Feishu |
| **可靠性** | 内存存储 | 持久化 | 消息不丢、会话可恢复 |
| **可访问** | 本地 only | 远程可用 | WebSocket API + Token 认证 |
| **用户体验** | 被动响应 | 主动+被动 | Heartbeat 提醒、定时任务 |
| **代码质量** | - | 可维护 | 测试覆盖 > 70%、文档完整 |

---

## 二、阶段规划

### 📍 Phase 0: 准备阶段 (Week 0)

**目标**: 环境准备、技术调研、架构设计

```
┌─────────────────────────────────────────────────────────────────┐
│ Week 0: 准备阶段                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ □ 技术调研                                                       │
│   ├─ 精读 nanobot 源码 (agent/loop.py, channels/, gateway/)     │
│   ├─ 研究 claw0 s05/s08/s10 实现                               │
│   └─ 分析 openclaw Gateway 协议                                 │
│                                                                  │
│ □ 架构设计                                                       │
│   ├─ 设计 Gateway API 规范 (JSON-RPC)                          │
│   ├─ 设计 Channel 抽象接口                                      │
│   ├─ 设计 Delivery Queue 数据结构                              │
│   └─ 设计 Session Store 迁移方案                               │
│                                                                  │
│ □ 环境准备                                                       │
│   ├─ 创建 feature/gateway 分支                                  │
│   ├─ 安装测试依赖 (pytest-asyncio, websockets)                 │
│   └─ 配置开发环境 (Telegram Bot Father, Discord App)           │
│                                                                  │
│ 交付物:                                                          │
│   - architecture/design-doc.md                                  │
│   - api/gateway-spec.json                                       │
│   - tests/test-plan.md                                          │
└─────────────────────────────────────────────────────────────────┘
```

---

### 📍 Phase 1: 基础设施 (Week 1-4)

**目标**: 实现 Gateway + Session Store + Delivery Queue

**里程碑 1**: Gateway Server 可运行，CLI 可连接

```
┌─────────────────────────────────────────────────────────────────┐
│ Week 1: Gateway 核心                                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ 模块: src/gateway/                                              │
│                                                                  │
│ □ Day 1-2: WebSocket 服务器框架                                 │
│   ├─ 实现 GatewayServer 类                                      │
│   ├─ 集成 websockets 库                                         │
│   └─ 连接管理 (连接池、心跳保活)                                │
│                                                                  │
│ □ Day 3-4: JSON-RPC 协议实现                                    │
│   ├─ 请求解析与响应封装                                         │
│   ├─ 方法路由表 (chat.send, health)                            │
│   └─ 错误处理规范                                               │
│                                                                  │
│ □ Day 5-7: 认证与流式输出                                       │
│   ├─ Bearer Token 认证中间件                                    │
│   ├─ 流式响应 (chat.send_stream)                               │
│   └─ 集成测试                                                   │
│                                                                  │
│ 关键代码:                                                        │
│   - gateway/server.py       (WebSocket 服务器)                 │
│   - gateway/protocol.py     (JSON-RPC 实现)                    │
│   - gateway/auth.py         (Token 认证)                       │
│                                                                  │
│ 验收标准:                                                        │
│   ✓ WebSocket 服务器启动成功 (ws://localhost:8080)             │
│   ✓ 客户端可连接并发送 chat.send                               │
│   ✓ Token 认证正常工作                                          │
│   ✓ 流式输出正常                                                │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 2: Session Store 重构                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ 模块: src/chat/session_store.py                                 │
│                                                                  │
│ □ Day 1-2: JSONL Session Store                                  │
│   ├─ Session 数据类设计 (与 claw0 兼容)                         │
│   ├─ JSONL 读写实现                                             │
│   └─ Session Key 规范 (agent:id:channel:peer)                  │
│                                                                  │
│ □ Day 3-4: 会话管理                                             │
│   ├─ 创建/获取/删除会话                                         │
│   ├─ 历史消息管理                                               │
│   └─ 会话归档 (30天自动归档)                                    │
│                                                                  │
│ □ Day 5-7: 集成与迁移                                           │
│   ├─ 重构 ChatSession 使用 SessionStore                        │
│   ├─ 数据迁移脚本 (内存 → JSONL)                               │
│   └─ 集成测试                                                   │
│                                                                  │
│ 关键代码:                                                        │
│   - chat/session_store.py   (会话存储)                         │
│   - chat/session.py         (会话对象)                         │
│   - scripts/migrate_sessions.py (迁移脚本)                     │
│                                                                  │
│ 验收标准:                                                        │
│   ✓ 会话持久化到 JSONL                                          │
│   ✓ 重启后会话可恢复                                            │
│   ✓ 支持多会话并发                                              │
│   ✓ 旧数据迁移成功                                              │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 3: Delivery Queue                                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ 模块: src/infra/delivery_queue.py                               │
│                                                                  │
│ □ Day 1-2: 队列核心                                             │
│   ├─ QueuedDelivery 数据类                                      │
│   ├─ 原子写入机制 (.tmp → rename)                              │
│   └─ 队列目录管理                                               │
│                                                                  │
│ □ Day 3-4: 重试机制                                             │
│   ├─ 指数退避 [5s, 25s, 2m, 10m]                               │
│   ├─ 重试计数与最大次数 (5次)                                   │
│   └─ 死信队列 (failed/)                                         │
│                                                                  │
│ □ Day 5-7: 工作线程与集成                                       │
│   ├─ 后台投递工作线程                                           │
│   ├─ 与 Gateway 集成                                            │
│   └─ 失败恢复机制 (启动时恢复pending)                          │
│                                                                  │
│ 关键代码:                                                        │
│   - infra/delivery_queue.py (投递队列)                         │
│   - infra/channel_handlers.py (通道处理器)                     │
│                                                                  │
│ 验收标准:                                                        │
│   ✓ 消息入队成功                                                  │
│   ✓ 失败自动重试                                                  │
│   ✓ 超过5次移入死信队列                                          │
│   ✓ 重启后恢复未投递消息                                          │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 4: 集成测试与优化                                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ □ Day 1-2: 端到端集成                                           │
│   ├─ Gateway + Session + Queue 集成                             │
│   ├─ CLI 通过 Gateway API 调用                                  │
│   └─ 完整对话流程测试                                           │
│                                                                  │
│ □ Day 3-4: 性能测试                                             │
│   ├─ 并发连接测试 (100+ 连接)                                   │
│   ├─ 消息吞吐测试                                               │
│   └─ 内存泄漏检查                                               │
│                                                                  │
│ □ Day 5-7: 文档与优化                                           │
│   ├─ Gateway API 文档                                           │
│   ├─ 部署指南                                                   │
│   └─ 性能优化 (连接池、缓存)                                    │
│                                                                  │
│ 交付物:                                                          │
│   - 可运行的 Gateway Server                                     │
│   - 完整的测试套件                                              │
│   - API 文档                                                    │
│                                                                  │
│ 里程碑 1 验收:                                                   │
│   ✓ Gateway 独立运行                                            │
│   ✓ CLI 可连接并正常对话                                        │
│   ✓ 会话持久化工作正常                                          │
│   ✓ 消息队列工作正常                                            │
└─────────────────────────────────────────────────────────────────┘
```

---

### 📍 Phase 2: 多通道支持 (Week 5-7)

**目标**: 实现 Telegram + Discord + Feishu 三大通道

**里程碑 2**: 可通过 Telegram Bot 与助手对话

```
┌─────────────────────────────────────────────────────────────────┐
│ Week 5: Channel 抽象与 Telegram                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ 模块: src/channels/                                             │
│                                                                  │
│ □ Day 1-2: Channel 抽象接口                                     │
│   ├─ BaseChannel ABC                                            │
│   ├─ InboundMessage / OutboundMessage 数据类                   │
│   └─ 消息标准化 (统一格式)                                      │
│                                                                  │
│ □ Day 3-5: Telegram Channel                                     │
│   ├─ 集成 python-telegram-bot                                   │
│   ├─ Webhook 模式支持                                           │
│   ├─ 消息格式转换                                               │
│   └─ 用户白名单 (allowFrom)                                     │
│                                                                  │
│ □ Day 6-7: Gateway 集成                                         │
│   ├─ Channel Manager (多通道管理)                               │
│   ├─ 路由分发 (Telegram → Agent → Response)                    │
│   └─ 端到端测试                                                 │
│                                                                  │
│ 关键代码:                                                        │
│   - channels/base.py          (抽象接口)                       │
│   - channels/telegram.py      (Telegram 实现)                  │
│   - channels/manager.py       (通道管理器)                     │
│                                                                  │
│ 验收标准:                                                        │
│   ✓ 可向 Telegram Bot 发送消息                                  │
│   ✓ Bot 正常回复                                                  │
│   ✓ 会话历史可查询                                                │
│   ✓ 支持流式输出                                                  │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 6: Discord + Feishu                                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ □ Day 1-3: Discord Channel                                      │
│   ├─ 集成 discord.py                                            │
│   ├─ Bot Token + Intents 配置                                   │
│   ├─ @mention 触发模式                                          │
│   └─ 长消息分片处理                                             │
│                                                                  │
│ □ Day 4-6: Feishu Channel                                       │
│   ├─ 集成飞书 SDK                                               │
│   ├─ WebSocket 长连接模式                                       │
│   ├─ 事件订阅配置                                               │
│   └─ 卡片消息支持                                               │
│                                                                  │
│ □ Day 7: 统一配置管理                                           │
│   ├─ config/channels.yaml 配置                                 │
│   ├─ 通道启停开关                                               │
│   └─ 监控面板                                                   │
│                                                                  │
│ 关键代码:                                                        │
│   - channels/discord.py       (Discord 实现)                   │
│   - channels/feishu.py        (Feishu 实现)                    │
│   - config/channels.py        (配置管理)                       │
│                                                                  │
│ 验收标准:                                                        │
│   ✓ Discord Bot 正常工作                                        │
│   ✓ Feishu Bot 正常工作                                         │
│   ✓ 配置热加载                                                    │
│   ✓ 多通道并发稳定                                                │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 7: 消息路由与优化                                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ □ Day 1-3: Message Routing                                      │
│   ├─ Binding 配置 (channel → agent)                            │
│   ├─ Session Key 构建                                           │
│   ├─ 多 Agent 路由 (基础版)                                     │
│   └─ 优先级匹配                                                 │
│                                                                  │
│ □ Day 4-5: 消息格式化                                           │
│   ├─ Markdown → 平台特定格式                                    │
│   ├─ 代码块、链接、列表处理                                     │
│   └─ 媒体消息支持 (图片、文件)                                  │
│                                                                  │
│ □ Day 6-7: 稳定性优化                                           │
│   ├─ 连接断线重连                                               │
│   ├─ 速率限制处理                                               │
│   ├─ 错误上报                                                   │
│   └─ 压力测试                                                   │
│                                                                  │
│ 交付物:                                                          │
│   - Telegram Bot (@YourBot)                                     │
│   - Discord Bot                                                   │
│   - Feishu Bot                                                    │
│   - 部署文档                                                      │
│                                                                  │
│ 里程碑 2 验收:                                                   │
│   ✓ 可通过任一通道与助手对话                                    │
│   ✓ 会话隔离正常                                                  │
│   ✓ 流式输出正常                                                  │
│   ✓ 24小时稳定性测试通过                                          │
└─────────────────────────────────────────────────────────────────┘
```

---

### 📍 Phase 3: 智能增强 (Week 8-10)

**目标**: Heartbeat 主动行为 + Subagent 后台任务

**里程碑 3**: 助手可主动发送提醒

```
┌─────────────────────────────────────────────────────────────────┐
│ Week 8: Enhanced Heartbeat                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ 模块: src/agent/heartbeat.py                                    │
│                                                                  │
│ □ Day 1-2: 6步检查链                                            │
│   ├─ enabled check                                              │
│   ├─ interval check                                             │
│   ├─ active_hours check                                         │
│   ├─ heartbeat_md exists                                        │
│   ├─ channel idle check                                         │
│   └─ agent idle check                                           │
│                                                                  │
│ □ Day 3-4: HEARTBEAT.md 支持                                    │
│   ├─ 文件解析与任务提取                                         │
│   ├─ 自然语言指令处理                                           │
│   └─ 用户自定义任务                                             │
│                                                                  │
│ □ Day 5-7: 主动行为执行                                         │
│   ├─ 24h 去重机制                                               │
│   ├─ 与用户消息互斥 (Lane 隔离)                                 │
│   ├─ 结果投递到最近活跃通道                                     │
│   └─ 集成测试                                                   │
│                                                                  │
│ 关键代码:                                                        │
│   - agent/heartbeat.py        (心跳运行器)                     │
│   - config/HEARTBEAT.md       (任务模板)                       │
│                                                                  │
│ 验收标准:                                                        │
│   ✓ 定时检查任务                                                  │
│   ✓ 6步检查全部通过才执行                                         │
│   ✓ 重复内容24h内不发送                                           │
│   ✓ 用户消息优先，不打扰                                          │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 9: Subagent 系统                                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ 模块: src/agent/subagent.py                                     │
│                                                                  │
│ □ Day 1-3: Subagent 基础                                        │
│   ├─ Subagent 类设计                                            │
│   ├─ 后台任务执行 (asyncio.create_task)                        │
│   ├─ 任务状态跟踪                                               │
│   └─ 进度流式返回                                               │
│                                                                  │
│ □ Day 4-6: 任务管理                                             │
│   ├─ 任务创建、暂停、取消                                       │
│   ├─ 任务结果存储                                               │
│   ├─ 超时处理                                                   │
│   └─ 错误恢复                                                   │
│                                                                  │
│ □ Day 7: 集成                                                   │
│   ├─ 通过 tool 调用 subagent                                    │
│   ├─ 结果通知用户                                               │
│   └─ 集成测试                                                   │
│                                                                  │
│ 关键代码:                                                        │
│   - agent/subagent.py         (子代理)                         │
│   - agent/tools/subagent.py   (subagent_spawn 工具)            │
│                                                                  │
│ 验收标准:                                                        │
│   ✓ 可启动后台任务                                                │
│   ✓ 任务可流式输出进度                                            │
│   ✓ 任务结果可查询                                                │
│   ✓ 任务可取消                                                    │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 10: 优化与完善                                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ □ Day 1-3: Webhook 触发器                                       │
│   ├─ HTTP Endpoint 接收外部事件                                 │
│   ├─ 签名验证                                                   │
│   ├─ 事件路由到 Agent                                           │
│   └─ 示例集成 (GitHub Webhook)                                  │
│                                                                  │
│ □ Day 4-5: 性能优化                                             │
│   ├─ 数据库连接池                                               │
│   ├─ 缓存优化 (LRU)                                             │
│   ├─ 异步任务队列                                               │
│   └─ 性能监控                                                   │
│                                                                  │
│ □ Day 6-7: 文档与示例                                           │
│   ├─ API 使用示例                                               │
│   ├─ 通道配置指南                                               │
│   ├─ 自定义技能开发指南                                         │
│   └─ 部署最佳实践                                               │
│                                                                  │
│ 里程碑 3 验收:                                                   │
│   ✓ Heartbeat 主动提醒工作正常                                  │
│   ✓ Subagent 后台任务工作正常                                   │
│   ✓ Webhook 可触发对话                                          │
│   ✓ 性能满足生产要求                                            │
└─────────────────────────────────────────────────────────────────┘
```

---

### 📍 Phase 4: 生态与优化 (Week 11-12)

**目标**: 更多通道 + 稳定性 + 文档

**里程碑 4**: 生产就绪 (Production Ready)

```
┌─────────────────────────────────────────────────────────────────┐
│ Week 11: 扩展通道与功能                                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ □ Day 1-3: Email Channel                                        │
│   ├─ IMAP 收件箱轮询                                            │
│   ├─ SMTP 回复发送                                              │
│   ├─ 邮件内容解析 (HTML → Text)                                 │
│   └─ 自动回复开关                                               │
│                                                                  │
│ □ Day 4-5: WhatsApp Channel (可选)                              │
│   ├─ whatsapp-web.js 桥接                                       │
│   ├─ QR 码登录                                                  │
│   └─ 消息同步                                                   │
│                                                                  │
│ □ Day 6-7: 浏览器控制 (可选)                                    │
│   ├─ Playwright 集成                                            │
│   ├─ browser_navigate 工具                                      │
│   ├─ browser_screenshot 工具                                    │
│   └─ browser_click/type 工具                                    │
│                                                                  │
│ 关键代码:                                                        │
│   - channels/email.py         (Email 实现)                     │
│   - channels/whatsapp.py      (WhatsApp 实现)                  │
│   - tools/browser.py          (浏览器控制)                     │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│ Week 12: 生产化与发布                                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│ □ Day 1-3: 监控与日志                                           │
│   ├─ 结构化日志 (JSON)                                          │
│   ├─ 指标收集 (Prometheus)                                      │
│   ├─ 健康检查端点                                               │
│   └─ 告警规则                                                   │
│                                                                  │
│ □ Day 4-5: Docker 与部署                                        │
│   ├─ Dockerfile 优化                                            │
│   ├─ docker-compose.yml                                         │
│   ├─ 环境变量配置                                               │
│   └─ systemd 服务文件                                           │
│                                                                  │
│ □ Day 6-7: 最终测试与发布                                       │
│   ├─ 端到端测试套件                                             │
│   ├─ 安全审计                                                   │
│   ├─ 文档最终检查                                               │
│   └─ 发布 v1.0 版本                                             │
│                                                                  │
│ 里程碑 4 验收:                                                   │
│   ✓ Docker 镜像可运行                                           │
│   ✓ 7x24 小时稳定性测试通过                                     │
│   ✓ 文档完整                                                      │
│   ✓ 发布版本 tag                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 三、技术选型

### 3.1 核心依赖

| 组件 | 选型 | 版本 | 理由 |
|------|------|------|------|
| **WebSocket** | `websockets` | ^12.0 | Python 原生，异步友好 |
| **HTTP** | `aiohttp` | ^3.9 | 与 websockets 配合良好 |
| **Telegram** | `python-telegram-bot` | ^20.0 | 官方维护，功能完整 |
| **Discord** | `discord.py` | ^2.3 | 社区活跃，文档完善 |
| **Feishu** | `lark-oapi` | ^1.0 | 官方 SDK，WebSocket 支持 |
| **Email** | `imaplib` + `aiosmtplib` | stdlib + ^3.0 | 标准库，轻量 |
| **测试** | `pytest` + `pytest-asyncio` | ^8.0 | 异步测试支持 |
| **监控** | `prometheus-client` | ^0.19 | 指标收集 |

### 3.2 目录结构规划

```
src/
├── gateway/                    # NEW: WebSocket Gateway
│   ├── __init__.py
│   ├── server.py              # WebSocket 服务器
│   ├── protocol.py            # JSON-RPC 协议
│   ├── auth.py                # Token 认证
│   └── handlers.py            # 方法处理器
│
├── channels/                   # NEW: 多通道支持
│   ├── __init__.py
│   ├── base.py                # Channel 抽象
│   ├── manager.py             # 通道管理器
│   ├── telegram.py            # Telegram 实现
│   ├── discord.py             # Discord 实现
│   ├── feishu.py              # Feishu 实现
│   └── email.py               # Email 实现
│
├── infra/                      # NEW: 基础设施
│   ├── __init__.py
│   ├── delivery_queue.py      # 投递队列
│   └── metrics.py             # 监控指标
│
├── agent/
│   ├── __init__.py
│   ├── supervisor.py          # EXISTING
│   ├── heartbeat.py           # NEW: 心跳运行器
│   └── subagent.py            # NEW: 子代理
│
├── chat/
│   ├── __init__.py
│   ├── session.py             # EXISTING
│   ├── session_store.py       # NEW: JSONL 存储
│   └── chat_session.py        # MODIFIED: 集成 SessionStore
│
├── memory/                     # EXISTING (无需大改)
├── tools/                      # EXISTING (无需大改)
├── schedule/                   # EXISTING (无需大改)
└── main.py                     # MODIFIED: 启动 Gateway
```

---

## 四、风险管理

### 4.1 风险矩阵

| 风险 | 概率 | 影响 | 应对策略 |
|------|------|------|----------|
| **Gateway 性能瓶颈** | 中 | 高 | 早期压力测试、连接池、水平扩展设计 |
| **通道 API 变更** | 中 | 中 | 抽象接口隔离、单元测试、快速迭代 |
| **内存泄漏** | 低 | 高 | 定期 profiling、连接回收、监控告警 |
| **安全漏洞** | 低 | 高 | Token 认证、输入验证、速率限制、审计 |
| **开发延期** | 中 | 中 | 里程碑检查、功能裁剪、并行开发 |
| **与现有代码冲突** | 低 | 高 | 保持兼容、功能开关、灰度发布 |

### 4.2 应急预案

```
场景 1: Gateway 性能不达标
├─ 措施: 启用缓存层、连接限流、水平扩展
└─ 降级: 回退到 CLI 模式

场景 2: Telegram API 限流
├─ 措施: 指数退避、消息队列缓冲
└─ 降级: 暂时禁用 Telegram，其他通道正常

场景 3: 新功能引入回归 Bug
├─ 措施: 快速回滚到上一版本
└─ 长期: 加强测试覆盖、CI/CD 流程
```

---

## 五、资源需求

### 5.1 开发资源

| 角色 | 人数 | 职责 |
|------|------|------|
| **后端开发** | 1-2 人 | Gateway、Channel、Queue 实现 |
| **算法工程师** | 0.5 人 | Agent 优化、Heartbeat 调优 |
| **测试工程师** | 0.5 人 | 测试用例、压力测试 |
| **技术写作** | 0.5 人 | 文档、教程 |

### 5.2 外部资源

| 资源 | 用途 | 成本 |
|------|------|------|
| **Telegram Bot** | 通道测试 | 免费 |
| **Discord App** | 通道测试 | 免费 |
| **Feishu App** | 通道测试 | 免费 |
| **VPS/云服务器** | 部署测试 | ~50元/月 |
| **Domain + SSL** | Webhook | ~100元/年 |

---

## 六、里程碑检查点

```
Week 0  ──────────────────────────────────────────────────────►
        │
        ▼ 检查点 0.1: 设计文档完成
        │
Week 4  ──────────────────────────────────────────────────────►
        │
        ▼ 里程碑 1: Gateway + Session + Queue
        │    ✓ WebSocket 服务器可连接
        │    ✓ CLI 通过 API 正常工作
        │    ✓ 会话持久化
        │    ✓ 消息队列可靠
        │
Week 7  ──────────────────────────────────────────────────────►
        │
        ▼ 里程碑 2: 多通道支持
        │    ✓ Telegram Bot 上线
        │    ✓ Discord Bot 上线
        │    ✓ Feishu Bot 上线
        │    ✓ 7x24 稳定运行
        │
Week 10 ──────────────────────────────────────────────────────►
        │
        ▼ 里程碑 3: 智能增强
        │    ✓ Heartbeat 主动提醒
        │    ✓ Subagent 后台任务
        │    ✓ Webhook 触发
        │
Week 12 ──────────────────────────────────────────────────────►
        │
        ▼ 里程碑 4: 生产就绪
             ✓ Docker 部署
             ✓ 监控告警
             ✓ 完整文档
             ✓ v1.0 发布
```

---

## 七、后续规划 (Post v1.0)

### 7.1 v1.1 计划 (Month 4)

- [ ] WhatsApp 通道完善
- [ ] Slack 通道增强 (Slash Commands)
- [ ] 浏览器控制稳定版
- [ ] 多语言支持 (i18n)

### 7.2 v1.2 计划 (Month 5-6)

- [ ] Voice Wake 语音唤醒
- [ ] Talk Mode 持续对话
- [ ] Canvas A2UI 支持
- [ ] 移动端 App (React Native)

### 7.3 长期愿景 (Year 2)

- [ ] 多 Agent 智能路由
- [ ] 插件市场 (Skill Store)
- [ ] 联邦学习 (隐私保护)
- [ ] 本地模型支持 (LLaMA.cpp)

---

## 附录

### A. 参考文档

- [nanobot 源码](https://github.com/HKUDS/nanobot)
- [claw0 教程](https://github.com/shareAI-lab/claw0)
- [openclaw 文档](https://docs.openclaw.ai)
- [本方案详细设计](./optimization-plan-v1.md)
- [架构对比分析](./architecture-comparison-v2.md)

### B. 项目看板

建议使用 GitHub Projects 或 Linear 管理任务：

```
Backlog      │ In Progress │ In Review   │ Done
─────────────┼─────────────┼─────────────┼─────────
             │             │             │
WhatsApp Ch  │ Telegram Ch │ Gateway API │ Design Doc
Slack Ch     │ Session     │ Auth        │ Test Plan
Voice Wake   │ Store       │             │
             │             │             │
```

### C. 沟通渠道

- **每日站会**: 15 分钟同步进度
- **周会**: 回顾本周，规划下周
- **里程碑评审**: 演示功能，收集反馈
- **技术讨论**: GitHub Discussions

---

**文档版本**: v1.0
**创建时间**: 2026-02-24
**下次评审**: Week 2 (里程碑 1)
